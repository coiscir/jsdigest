<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title>jsDigest</title>
  <link rel="stylesheet" type="text/css" href="test.css" />
</head>

<body>
<ul id="results"></ul>
<script type="text/javascript" src="test.js"></script>

<script type="text/javascript" src="../lib/digest.js"></script>
<script type="text/javascript" src="../lib/digest-more.js"></script>
<script type="text/javascript">
var md6_block = '\x11\x22\x33\x44\x55\x66\x77';
while (md6_block.length < 800) md6_block += md6_block;
var md6_block_400 = md6_block.substr(0, 400);
var md6_block_800 = md6_block.substr(0, 800);
var md6_block_600 = md6_block.substr(0, 600);

var md6_start = new Date().getTime();

log('== MD6 ==');
test(true, !!Digest.md6par, 'Digest.md6par is defined');
test(true, !!Digest.md6seq, 'Digest.md6seq is defined');
space();
log('MD6-PAR (Parallel/Tree)');
test('7538e7552a2e9cc94be251f73ce9cf67d4739b4b3f114e483ea38ab0', Digest.md6par(224, md6_block_400).hex(), 'MD6-PAR-224 1 Block, Key 0');
test('fb75daf08d970c19f49b34ec768fea1a74583a5b1d1df2149a61cb36e120d197', Digest.md6par(256, md6_block_400, '111222333').hex(), 'MD6-PAR-256 1 Block, Key 9');
test('614cec06b9a0332f8c14d7d4f29934e4f39b91046c1c2cd1fa9f84fc3ed2e89efb583003b2fc9e996cb690a8be68dbf2', Digest.md6par(384, md6_block_800).hex(), 'MD6-PAR-384 2-Block, Key 0');
test('48e8dbfee51e36b0c549925ed9740df0d4e0aa9d46c5ec5bd7749a8c023b91582bb3fa07b311a4d3e774ebf5b5beffe806eea425c37af320ef06ff241bcb32e4', Digest.md6par(512, md6_block_800, '111222333').hex(), 'MD6-PAR-512 2-Block, Key 9');
space();
log('MD6-SEQ (Sequential)');
test('b81b7d4d84c3df8104b447445e6d87693f62fe91380b01ecc4bb0af4', Digest.md6seq(224, md6_block_400).hex(), 'MD6-SEQ-224 1-Block');
test('e9eaf4c30140a4e7649a34b6d4976a930bf5681ea8a7e1a2471a1035d8eebb95', Digest.md6seq(256, md6_block_600).hex(), 'MD6-SEQ-256 2-Block');
test('de4f6f3715d87cefbb339eeae677a8594c7949a61ecf694dc12fd3243b42517a356b60837a2bffbd39a18401cb74db02', Digest.md6seq(384, md6_block_400).hex(), 'MD6-SEQ-384 1-Block');
test('753c2fd701db4a9d4244ffd7e873858c10b9820193ac7e34202b3c94ca8b809e8fca74cd7eb46eebbd15a204bd236113c700a71cb582e06fab3fa321ad2cffcd', Digest.md6seq(512, md6_block_600).hex(), 'MD6-SEQ-512 2-Block');

space();
timed(new Date().getTime() - md6_start);
</script>
<script type="text/javascript">
space();
log('<hr />');
</script>
<script type="text/javascript">
var skein_kat_FF = '\xFF';
var skein_kat_E0 = skein_kat_FF + '\xFE\xFD\xFC\xFB\xFA\xF9\xF8\xF7\xF6\xF5\xF4\xF3\xF2\xF1\xF0\xEF\xEE\xED\xEC\xEB\xEA\xE9\xE8\xE7\xE6\xE5\xE4\xE3\xE2\xE1\xE0';
var skein_kat_C0 = skein_kat_E0 + '\xDF\xDE\xDD\xDC\xDB\xDA\xD9\xD8\xD7\xD6\xD5\xD4\xD3\xD2\xD1\xD0\xCF\xCE\xCD\xCC\xCB\xCA\xC9\xC8\xC7\xC6\xC5\xC4\xC3\xC2\xC1\xC0';
var skein_kat_80 = skein_kat_C0 + '\xBF\xBE\xBD\xBC\xBB\xBA\xB9\xB8\xB7\xB6\xB5\xB4\xB3\xB2\xB1\xB0\xAF\xAE\xAD\xAC\xAB\xAA\xA9\xA8\xA7\xA6\xA5\xA4\xA3\xA2\xA1\xA0\x9F\x9E\x9D\x9C\x9B\x9A\x99\x98\x97\x96\x95\x94\x93\x92\x91\x90\x8F\x8E\x8D\x8C\x8B\x8A\x89\x88\x87\x86\x85\x84\x83\x82\x81\x80';
var skein_kat_00 = skein_kat_80 + '\x7F\x7E\x7D\x7C\x7B\x7A\x79\x78\x77\x76\x75\x74\x73\x72\x71\x70\x6F\x6E\x6D\x6C\x6B\x6A\x69\x68\x67\x66\x65\x64\x63\x62\x61\x60\x5F\x5E\x5D\x5C\x5B\x5A\x59\x58\x57\x56\x55\x54\x53\x52\x51\x50\x4F\x4E\x4D\x4C\x4B\x4A\x49\x48\x47\x46\x45\x44\x43\x42\x41\x40\x3F\x3E\x3D\x3C\x3B\x3A\x39\x38\x37\x36\x35\x34\x33\x32\x31\x30\x2F\x2E\x2D\x2C\x2B\x2A\x29\x28\x27\x26\x25\x24\x23\x22\x21\x20\x1F\x1E\x1D\x1C\x1B\x1A\x19\x18\x17\x16\x15\x14\x13\x12\x11\x10\x0F\x0E\x0D\x0C\x0B\x0A\x09\x08\x07\x06\x05\x04\x03\x02\x01\x00';

var skein_start = new Date().getTime();

log('== Skein ==');
test(true, !!Digest.skein256,  'Digest.skein256 is defined ');
test(true, !!Digest.skein512,  'Digest.skein512 is defined ');
test(true, !!Digest.skein1024, 'Digest.skein1024 is defined');
space();
log('Specification Test Vectors');
test('42C88237B63FC99C55098838A171D50BFBFFCAF340705C923BBB3745D14715E8', Digest.skein256(256, skein_kat_FF, false).base16(), 'Skein-256-256 Short');
test('E33F483B1389BA9FAEFF25257E87CF76008C35285E3BD562BDC1F3EA2A960635', Digest.skein256(256, skein_kat_E0, false).base16(), 'Skein-256-256 Equal');
test('90E50C4DCFC7490A09F3A1A79BF3B3DF21EA85447B0FF029C847D659856EC7A5', Digest.skein256(256, skein_kat_C0, false).base16(), 'Skein-256-256 Long ');
space();
test('42AA6BD9CA92E90EA28DF6F6F2D0D9B85A2D1907EE4DC1B171ACE7EB1159BE3BD1BC56586D92492B6EFF9BE03306994C65A332C4C24160F46655040E558E8329', Digest.skein512(512, skein_kat_FF, false).base16(), 'Skein-512-512 Short');
test('04F96C6F61B3E237A4FA7755EE4ACF34494222968954F495AD147A1A715F7A73EBECFA1EF275BED87DC60BD1A0BC602106FA98F8E7237BD1AC0958E76D306678', Digest.skein512(512, skein_kat_C0, false).base16(), 'Skein-512-512 Equal');
test('B484AE9FB73E6620B10D52E49260AD26620DB2883EBAFA210D701922ACA85368088144BDF4EF3D9898D47C34F130031B0A0992F09F62DD78B329525A777DAF7D', Digest.skein512(512, skein_kat_80, false).base16(), 'Skein-512-512 Long ');
space();
test('A204C394923416B820686E1B449CA4277A477CA9DB084DD931715B102A43F045BC3483AEE0288608916710F875DF8D79424997465328B517BAC30996FBFA642BCC446E157A45D02F0878DAA3556139A76C2CFEC283072196B33A128354CBDB6DB9DBA879C71CB10C77E929786D2FBAFDE6A05529E26B20FF3BBB7B475CAA7115', Digest.skein1024(1024, skein_kat_FF, false).base16(), 'Skein-1024-1024 Short');
test('C2E6B6FC042F86F2E31738641DB60295F74204AB525895A5DEC5C806AC4786EC1C982920095B7129FE3D8BD451F67EA31320C78B11575EA6DDE394E75DC5F5C96A5104386DD55016D494DFFAC5AD119B22C960DC46B658CF2CEB7D73AF0FD0E19C7E21344AAD06AF39FCBEF6C6C5D00DE896B888D95456DEDBA6E5377B0CC572', Digest.skein1024(1024, skein_kat_80, false).base16(), 'Skein-1024-1024 Equal');
test('64661F7DC4ABBB50003EAEA69242018D27AEB415CA7B891FBDDBC1C69040D4C4A9822133E60E222AF7EE09349C3F1C4CC8F38111A505E86393E7284180602DB630AE763D9A620AE4932A823415B59515AEEC556418ED2EF0827189D54E6576D41D961EDDCBBD871E6F1B6BA625DC684CBBC204888B18687ED627506070006B82', Digest.skein1024(1024, skein_kat_00, false).base16(), 'Skein-1024-1024 Long ');
space();
log('SHA-3 KAT');
test('C3A155F5B069A7C5CC9E6D1C0D8246DD57C759783F732487AC147537', Digest.skein256(224, '', false).base16(), 'Skein-256-224 {0}');
test('4F4BBD31FD0AD2B14D2CD8BD526DA49687E1F5A8A399797F8901D0FE', Digest.skein256(224, '\xCC', false).base16(), 'Skein-256-224 {8}');
test('0B04103B828CDDAEBCF592AC845ECAFD5887F61230A755406D38D85376E1AE08', Digest.skein256(256, '', false).base16(), 'Skein-256-256 {0}');
test('37D304B6E5B230EC0288E7DACBAD145AEFD620268C5D6E06F5F717A4B17AB3EA', Digest.skein256(256, '\xCC', false).base16(), 'Skein-256-256 {8}');
test('2C3FE10673F4D6904F27585FC3DF455A678BC12D7D39D6BE4B37F47B80A43889181103BC727A7DB4B4E2D2DEC1DED86A', Digest.skein512(384, '', false).base16(), 'Skein-512-384 {0}');
test('153100603EA72AC9379541D7D9E5D9D2A29B54CEDCD02BDB254C8A3A967CF18C9F01149D1829A75E57BFCD7061741636', Digest.skein512(384, '\xCC', false).base16(), 'Skein-512-384 {8}');
test('5AF68A4912E0A6187A004947A9D2A37D7A1F0873F0BDD9DC64838ECE60DA5535C2A55D039BD58E178948996B7A8336486ED969C894BE658E47D595A5A9B86A8B', Digest.skein512(512, '', false).base16(), 'Skein-512-512 {0}');
test('D44B1D69E638D37908EE7C9EB212F4FBE465F2B383476C19BB5516E2A365BE1FB33BD8E14B4E03539816B9E1430AEB6B16146E91D03BCE7968A35D7DAA4F9416', Digest.skein512(512, '\xCC', false).base16(), 'Skein-512-512 {8}');

space();
timed(new Date().getTime() - skein_start);
</script>

</body>
</html>
