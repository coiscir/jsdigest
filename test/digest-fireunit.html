<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title>jsDigest</title>
  <link rel="stylesheet" type="text/css" href="test.css" />
</head>

<body>
<ul id="triggers"></ul>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script src="../lib/digest-dev.js"></script>
<script>
var
  md6_block, md6_block_400, md6_block_600, md6_block_800,
  skein_kat_FF, skein_kat_E0, skein_kat_C0, skein_kat_80, skein_kat_00,
  start;

md6_block = '\x11\x22\x33\x44\x55\x66\x77';
while (md6_block.length < 800) {
  md6_block += md6_block;
}
md6_block_400 = md6_block.substr(0, 400);
md6_block_800 = md6_block.substr(0, 800);
md6_block_600 = md6_block.substr(0, 600);

skein_kat_FF = '\xFF';
skein_kat_E0 = skein_kat_FF + '\xFE\xFD\xFC\xFB\xFA\xF9\xF8\xF7\xF6\xF5\xF4\xF3\xF2\xF1\xF0\xEF\xEE\xED\xEC\xEB\xEA\xE9\xE8\xE7\xE6\xE5\xE4\xE3\xE2\xE1\xE0';
skein_kat_C0 = skein_kat_E0 + '\xDF\xDE\xDD\xDC\xDB\xDA\xD9\xD8\xD7\xD6\xD5\xD4\xD3\xD2\xD1\xD0\xCF\xCE\xCD\xCC\xCB\xCA\xC9\xC8\xC7\xC6\xC5\xC4\xC3\xC2\xC1\xC0';
skein_kat_80 = skein_kat_C0 + '\xBF\xBE\xBD\xBC\xBB\xBA\xB9\xB8\xB7\xB6\xB5\xB4\xB3\xB2\xB1\xB0\xAF\xAE\xAD\xAC\xAB\xAA\xA9\xA8\xA7\xA6\xA5\xA4\xA3\xA2\xA1\xA0\x9F\x9E\x9D\x9C\x9B\x9A\x99\x98\x97\x96\x95\x94\x93\x92\x91\x90\x8F\x8E\x8D\x8C\x8B\x8A\x89\x88\x87\x86\x85\x84\x83\x82\x81\x80';
skein_kat_00 = skein_kat_80 + '\x7F\x7E\x7D\x7C\x7B\x7A\x79\x78\x77\x76\x75\x74\x73\x72\x71\x70\x6F\x6E\x6D\x6C\x6B\x6A\x69\x68\x67\x66\x65\x64\x63\x62\x61\x60\x5F\x5E\x5D\x5C\x5B\x5A\x59\x58\x57\x56\x55\x54\x53\x52\x51\x50\x4F\x4E\x4D\x4C\x4B\x4A\x49\x48\x47\x46\x45\x44\x43\x42\x41\x40\x3F\x3E\x3D\x3C\x3B\x3A\x39\x38\x37\x36\x35\x34\x33\x32\x31\x30\x2F\x2E\x2D\x2C\x2B\x2A\x29\x28\x27\x26\x25\x24\x23\x22\x21\x20\x1F\x1E\x1D\x1C\x1B\x1A\x19\x18\x17\x16\x15\x14\x13\x12\x11\x10\x0F\x0E\x0D\x0C\x0B\x0A\x09\x08\x07\x06\x05\x04\x03\x02\x01\x00';

$(document).ready(function() {
  if (typeof fireunit === 'undefined') {
    $('#triggers').html('<li><span class="fail">FAIL</span> FireUnit is not available.</li>')
    return;
  }
  
  var tests = [
    ['MD4', function() {
      Digest.md4('', 'passphrase').hex();
      Digest.md4('abc').base16();
      Digest.md4('message', 'passphrase').base32();
      Digest.md4('abcdefghijklmnopqrstuvwxyz').base32hex();
      Digest.md4('1234567890123456789012345678901234567890123456789012345', 'passphrase').base64();
      Digest.md4('12345678901234567890123456789012345678901234567890123456').base64url();
    }],
    ['MD5', function() {
      Digest.md5('', 'passphrase').hex();
      Digest.md5('abc').base16();
      Digest.md5('message', 'passphrase').base32();
      Digest.md5('abcdefghijklmnopqrstuvwxyz').base32hex();
      Digest.md5('1234567890123456789012345678901234567890123456789012345', 'passphrase').base64();
      Digest.md5('12345678901234567890123456789012345678901234567890123456').base64url();
    }],
    ['MD6', function() {
      Digest.md6par(224, Digest.stoa(md6_block_400)).hex();
      Digest.md6seq(256, Digest.stoa(md6_block_600)).hex();
      Digest.md6par(384, Digest.stoa(md6_block_400), '111222333').hex();
      Digest.md6seq(512, Digest.stoa(md6_block_600)).hex();
      Digest.md6par(512, Digest.stoa(md6_block_800), '111222333').hex();
    }],
    ['SHA-1', function() {
      Digest.sha1('', 'passphrase').hex();
      Digest.sha1('abc').base16();
      Digest.sha1('message', 'passphrase').base32();
      Digest.sha1('abcdefghijklmnopqrstuvwxyz').base32hex();
      Digest.sha1('1234567890123456789012345678901234567890123456789012345', 'passphrase').base64();
      Digest.sha1('12345678901234567890123456789012345678901234567890123456').base64url();
    }],
    ['SHA-224', function() {
      Digest.sha224('', 'passphrase').hex();
      Digest.sha224('abc').base16();
      Digest.sha224('message', 'passphrase').base32();
      Digest.sha224('abcdefghijklmnopqrstuvwxyz').base32hex();
      Digest.sha224('1234567890123456789012345678901234567890123456789012345', 'passphrase').base64();
      Digest.sha224('12345678901234567890123456789012345678901234567890123456').base64url();
    }],
    ['SHA-256', function() {
      Digest.sha256('', 'passphrase').hex();
      Digest.sha256('abc').base16();
      Digest.sha256('message', 'passphrase').base32();
      Digest.sha256('abcdefghijklmnopqrstuvwxyz').base32hex();
      Digest.sha256('1234567890123456789012345678901234567890123456789012345', 'passphrase').base64();
      Digest.sha256('12345678901234567890123456789012345678901234567890123456').base64url();
    }],
    ['SHA-384', function() {
      Digest.sha384('', 'passphrase').hex();
      Digest.sha384('abc').base16();
      Digest.sha384('message', 'passphrase').base32();
      Digest.sha384('abcdefghijklmnopqrstuvwxyz').base32hex();
      Digest.sha384('123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901', 'passphrase').base64();
      Digest.sha384('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012').base64url();
    }],
    ['SHA-512', function() {
      Digest.sha512('', 'passphrase').hex();
      Digest.sha512('abc').base16();
      Digest.sha512('message', 'passphrase').base32();
      Digest.sha512('abcdefghijklmnopqrstuvwxyz').base32hex();
      Digest.sha512('123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901', 'passphrase').base64();
      Digest.sha512('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012').base64url();
    }],
    ['Skein', function() {
      Digest.skein256(256, Digest.stoa(skein_kat_FF), 'passphrase').base16();
      Digest.skein256(256, Digest.stoa(skein_kat_C0)).base16();
      Digest.skein512(512, Digest.stoa(skein_kat_FF), 'passphrase').base16();
      Digest.skein512(512, Digest.stoa(skein_kat_80)).base16();
      Digest.skein1024(1024, Digest.stoa(skein_kat_FF), 'passphrase').base16();
      Digest.skein1024(1024, Digest.stoa(skein_kat_00)).base16();
    }]
  ].forEach(function(item) {
    var name = item[0],
        func = item[1];
    
    $('#triggers').append('<li><a id="' + name + '" href="#"></a></li>');
    
    $('#' + name).text(name).click(function(event) {
      $('#triggers .current').removeClass('current');
      $(this).parent().addClass('current');
      
      console.clear();
      fireunit.profile(func);
      event.preventDefault();
    });
  });
});
</script>

</body>
</html>
